/**
 * @remix-run/router v1.3.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function P(){return P=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},P.apply(this,arguments)}var O;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(O||(O={}));const We="popstate";function Dr(e){e===void 0&&(e={});function t(a,s){let{pathname:d="/",search:u="",hash:h=""}=Q(a.location.hash.substr(1));return ye("",{pathname:d,search:u,hash:h},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(a,s){let d=a.document.querySelector("base"),u="";if(d&&d.getAttribute("href")){let h=a.location.href,f=h.indexOf("#");u=f===-1?h:h.slice(0,f)}return u+"#"+(typeof s=="string"?s:ae(s))}function n(a,s){Ot(a.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(s)+")")}return jt(t,r,n,e)}function U(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Ot(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function _t(){return Math.random().toString(36).substr(2,8)}function ze(e,t){return{usr:e.state,key:e.key,idx:t}}function ye(e,t,r,n){return r===void 0&&(r=null),P({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Q(t):t,{state:r,key:t&&t.key||n||_t()})}function ae(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Q(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function jt(e,t,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:s=!1}=n,d=a.history,u=O.Pop,h=null,f=y();f==null&&(f=0,d.replaceState(P({},d.state,{idx:f}),""));function y(){return(d.state||{idx:null}).idx}function x(){u=O.Pop;let b=y(),T=b==null?null:b-f;f=b,h&&h({action:u,location:E.location,delta:T})}function M(b,T){u=O.Push;let A=ye(E.location,b,T);r&&r(A,b),f=y()+1;let N=ze(A,f),C=E.createHref(A);try{d.pushState(N,"",C)}catch{a.location.assign(C)}s&&h&&h({action:u,location:E.location,delta:1})}function o(b,T){u=O.Replace;let A=ye(E.location,b,T);r&&r(A,b),f=y();let N=ze(A,f),C=E.createHref(A);d.replaceState(N,"",C),s&&h&&h({action:u,location:E.location,delta:0})}function L(b){let T=a.location.origin!=="null"?a.location.origin:a.location.href,A=typeof b=="string"?b:ae(b);return U(T,"No window.location.(origin|href) available to create URL for href: "+A),new URL(A,T)}let E={get action(){return u},get location(){return e(a,d)},listen(b){if(h)throw new Error("A history only accepts one active listener");return a.addEventListener(We,x),h=b,()=>{a.removeEventListener(We,x),h=null}},createHref(b){return t(a,b)},createURL:L,encodeLocation(b){let T=L(b);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:M,replace:o,go(b){return d.go(b)}};return E}var _;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(_||(_={}));function kt(e){return e.index===!0}function at(e,t,r){return t===void 0&&(t=[]),r===void 0&&(r=new Set),e.map((n,a)=>{let s=[...t,a],d=typeof n.id=="string"?n.id:s.join("-");return U(n.index!==!0||!n.children,"Cannot specify children on an index route"),U(!r.has(d),'Found a route id collision on id "'+d+`".  Route id's must be globally unique within Data Router usages`),r.add(d),kt(n)?P({},n,{id:d}):P({},n,{id:d,children:n.children?at(n.children,s,r):void 0})})}function me(e,t,r){r===void 0&&(r="/");let n=typeof t=="string"?Q(t):t,a=_e(n.pathname||"/",r);if(a==null)return null;let s=it(e);It(s);let d=null;for(let u=0;d==null&&u<s.length;++u)d=Yt(s[u],Jt(a));return d}function it(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(s,d,u)=>{let h={relativePath:u===void 0?s.path||"":u,caseSensitive:s.caseSensitive===!0,childrenIndex:d,route:s};h.relativePath.startsWith("/")&&(U(h.relativePath.startsWith(n),'Absolute route path "'+h.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),h.relativePath=h.relativePath.slice(n.length));let f=pe([n,h.relativePath]),y=r.concat(h);s.children&&s.children.length>0&&(U(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+f+'".')),it(s.children,t,y,f)),!(s.path==null&&!s.index)&&t.push({path:f,score:zt(f,s.index),routesMeta:y})};return e.forEach((s,d)=>{var u;if(s.path===""||!((u=s.path)!=null&&u.includes("?")))a(s,d);else for(let h of ot(s.path))a(s,d,h)}),t}function ot(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return a?[s,""]:[s];let d=ot(n.join("/")),u=[];return u.push(...d.map(h=>h===""?s:[s,h].join("/"))),a&&u.push(...d),u.map(h=>e.startsWith("/")&&h===""?"/":h)}function It(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:Vt(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const Nt=/^:\w+$/,Ht=3,Kt=2,$t=1,Bt=10,Wt=-2,Ve=e=>e==="*";function zt(e,t){let r=e.split("/"),n=r.length;return r.some(Ve)&&(n+=Wt),t&&(n+=Kt),r.filter(a=>!Ve(a)).reduce((a,s)=>a+(Nt.test(s)?Ht:s===""?$t:Bt),n)}function Vt(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function Yt(e,t){let{routesMeta:r}=e,n={},a="/",s=[];for(let d=0;d<r.length;++d){let u=r[d],h=d===r.length-1,f=a==="/"?t:t.slice(a.length)||"/",y=qt({path:u.relativePath,caseSensitive:u.caseSensitive,end:h},f);if(!y)return null;Object.assign(n,y.params);let x=u.route;s.push({params:n,pathname:pe([a,y.pathname]),pathnameBase:tr(pe([a,y.pathnameBase])),route:x}),y.pathnameBase!=="/"&&(a=pe([a,y.pathnameBase]))}return s}function qt(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=Gt(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let s=a[0],d=s.replace(/(.)\/+$/,"$1"),u=a.slice(1);return{params:n.reduce((f,y,x)=>{if(y==="*"){let M=u[x]||"";d=s.slice(0,s.length-M.length).replace(/(.)\/+$/,"$1")}return f[y]=Xt(u[x]||"",y),f},{}),pathname:s,pathnameBase:d,pattern:e}}function Gt(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),ve(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(d,u)=>(n.push(u),"/([^\\/]+)"));return e.endsWith("*")?(n.push("*"),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function Jt(e){try{return decodeURI(e)}catch(t){return ve(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Xt(e,t){try{return decodeURIComponent(e)}catch(r){return ve(!1,'The value for the URL param "'+t+'" will not be decoded because'+(' the string "'+e+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+r+").")),e}}function _e(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function ve(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Qt(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?Q(e):e;return{pathname:r?r.startsWith("/")?r:Zt(r,t):t,search:rr(n),hash:nr(a)}}function Zt(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function Ce(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function lt(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function er(e,t,r,n){n===void 0&&(n=!1);let a;typeof e=="string"?a=Q(e):(a=P({},e),U(!a.pathname||!a.pathname.includes("?"),Ce("?","pathname","search",a)),U(!a.pathname||!a.pathname.includes("#"),Ce("#","pathname","hash",a)),U(!a.search||!a.search.includes("#"),Ce("#","search","hash",a)));let s=e===""||a.pathname==="",d=s?"/":a.pathname,u;if(n||d==null)u=r;else{let x=t.length-1;if(d.startsWith("..")){let M=d.split("/");for(;M[0]==="..";)M.shift(),x-=1;a.pathname=M.join("/")}u=x>=0?t[x]:"/"}let h=Qt(a,u),f=d&&d!=="/"&&d.endsWith("/"),y=(s||d===".")&&r.endsWith("/");return!h.pathname.endsWith("/")&&(f||y)&&(h.pathname+="/"),h}const pe=e=>e.join("/").replace(/\/\/+/g,"/"),tr=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),rr=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,nr=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;class Ye extends Error{}class ar{constructor(t,r){this.pendingKeysSet=new Set,this.subscribers=new Set,this.deferredKeys=[],U(t&&typeof t=="object"&&!Array.isArray(t),"defer() only accepts plain objects");let n;this.abortPromise=new Promise((s,d)=>n=d),this.controller=new AbortController;let a=()=>n(new Ye("Deferred data aborted"));this.unlistenAbortSignal=()=>this.controller.signal.removeEventListener("abort",a),this.controller.signal.addEventListener("abort",a),this.data=Object.entries(t).reduce((s,d)=>{let[u,h]=d;return Object.assign(s,{[u]:this.trackPromise(u,h)})},{}),this.done&&this.unlistenAbortSignal(),this.init=r}trackPromise(t,r){if(!(r instanceof Promise))return r;this.deferredKeys.push(t),this.pendingKeysSet.add(t);let n=Promise.race([r,this.abortPromise]).then(a=>this.onSettle(n,t,null,a),a=>this.onSettle(n,t,a));return n.catch(()=>{}),Object.defineProperty(n,"_tracked",{get:()=>!0}),n}onSettle(t,r,n,a){return this.controller.signal.aborted&&n instanceof Ye?(this.unlistenAbortSignal(),Object.defineProperty(t,"_error",{get:()=>n}),Promise.reject(n)):(this.pendingKeysSet.delete(r),this.done&&this.unlistenAbortSignal(),n?(Object.defineProperty(t,"_error",{get:()=>n}),this.emit(!1,r),Promise.reject(n)):(Object.defineProperty(t,"_data",{get:()=>a}),this.emit(!1,r),a))}emit(t,r){this.subscribers.forEach(n=>n(t,r))}subscribe(t){return this.subscribers.add(t),()=>this.subscribers.delete(t)}cancel(){this.controller.abort(),this.pendingKeysSet.forEach((t,r)=>this.pendingKeysSet.delete(r)),this.emit(!0)}async resolveData(t){let r=!1;if(!this.done){let n=()=>this.cancel();t.addEventListener("abort",n),r=await new Promise(a=>{this.subscribe(s=>{t.removeEventListener("abort",n),(s||this.done)&&a(s)})})}return r}get done(){return this.pendingKeysSet.size===0}get unwrappedData(){return U(this.data!==null&&this.done,"Can only unwrap data on initialized and settled deferreds"),Object.entries(this.data).reduce((t,r)=>{let[n,a]=r;return Object.assign(t,{[n]:or(a)})},{})}get pendingKeys(){return Array.from(this.pendingKeysSet)}}function ir(e){return e instanceof Promise&&e._tracked===!0}function or(e){if(!ir(e))return e;if(e._error)throw e._error;return e._data}class st{constructor(t,r,n,a){a===void 0&&(a=!1),this.status=t,this.statusText=r||"",this.internal=a,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}}function lr(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const dt=["post","put","patch","delete"],sr=new Set(dt),dr=["get",...dt],cr=new Set(dr),ur=new Set([301,302,303,307,308]),fr=new Set([307,308]),Fe={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0},hr={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0},qe={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},ct=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ut=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",mr=!ut;function Mr(e){U(e.routes.length>0,"You must provide a non-empty routes array to createRouter");let t=at(e.routes),r,n=null,a=new Set,s=null,d=null,u=null,h=e.hydrationData!=null,f=me(t,e.history.location,e.basename),y=null;if(f==null){let i=q(404,{pathname:e.history.location.pathname}),{matches:l,route:c}=et(t);f=l,y={[c.id]:i}}let x=!f.some(i=>i.route.loader)||e.hydrationData!=null,M,o={historyAction:e.history.action,location:e.history.location,matches:f,initialized:x,navigation:Fe,restoreScrollPosition:e.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:e.hydrationData&&e.hydrationData.loaderData||{},actionData:e.hydrationData&&e.hydrationData.actionData||null,errors:e.hydrationData&&e.hydrationData.errors||y,fetchers:new Map,blockers:new Map},L=O.Pop,E=!1,b,T=!1,A=!1,N=[],C=[],R=new Map,H=0,B=-1,$=new Map,Z=new Set,J=new Map,ee=new Map,X=new Map,Pe=!1;function yt(){return n=e.history.listen(i=>{let{action:l,location:c,delta:m}=i;if(Pe){Pe=!1;return}ve(X.size===0||m!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let p=Ke({currentLocation:o.location,nextLocation:c,historyAction:l});if(p&&m!=null){Pe=!0,e.history.go(m*-1),we(p,{state:"blocked",location:c,proceed(){we(p,{state:"proceeding",proceed:void 0,reset:void 0,location:c}),e.history.go(m)},reset(){ce(p),j({blockers:new Map(M.state.blockers)})}});return}return te(l,c)}),o.initialized||te(O.Pop,o.location),M}function vt(){n&&n(),a.clear(),b&&b.abort(),o.fetchers.forEach((i,l)=>Ae(l)),o.blockers.forEach((i,l)=>ce(l))}function bt(i){return a.add(i),()=>a.delete(i)}function j(i){o=P({},o,i),a.forEach(l=>l(o))}function se(i,l){var c,m;let p=o.actionData!=null&&o.navigation.formMethod!=null&&G(o.navigation.formMethod)&&o.navigation.state==="loading"&&((c=i.state)==null?void 0:c._isRedirect)!==!0,w;l.actionData?Object.keys(l.actionData).length>0?w=l.actionData:w=null:p?w=o.actionData:w=null;let v=l.loaderData?Ze(o.loaderData,l.loaderData,l.matches||[],l.errors):o.loaderData;for(let[g]of X)ce(g);let D=E===!0||o.navigation.formMethod!=null&&G(o.navigation.formMethod)&&((m=i.state)==null?void 0:m._isRedirect)!==!0;r&&(t=r,r=void 0),j(P({},l,{actionData:w,loaderData:v,historyAction:L,location:i,initialized:!0,navigation:Fe,revalidation:"idle",restoreScrollPosition:$e(i,l.matches||o.matches),preventScrollReset:D,blockers:new Map(o.blockers)})),T||L===O.Pop||(L===O.Push?e.history.push(i,i.state):L===O.Replace&&e.history.replace(i,i.state)),L=O.Pop,E=!1,T=!1,A=!1,N=[],C=[]}async function je(i,l){if(typeof i=="number"){e.history.go(i);return}let{path:c,submission:m,error:p}=Ge(i,l),w=o.location,v=ye(o.location,c,l&&l.state);v=P({},v,e.history.encodeLocation(v));let D=l&&l.replace!=null?l.replace:void 0,g=O.Push;D===!0?g=O.Replace:D===!1||m!=null&&G(m.formMethod)&&m.formAction===o.location.pathname+o.location.search&&(g=O.Replace);let k=l&&"preventScrollReset"in l?l.preventScrollReset===!0:void 0,S=Ke({currentLocation:w,nextLocation:v,historyAction:g});if(S){we(S,{state:"blocked",location:v,proceed(){we(S,{state:"proceeding",proceed:void 0,reset:void 0,location:v}),je(i,l)},reset(){ce(S),j({blockers:new Map(o.blockers)})}});return}return await te(g,v,{submission:m,pendingError:p,preventScrollReset:k,replace:l&&l.replace})}function wt(){if(Se(),j({revalidation:"loading"}),o.navigation.state!=="submitting"){if(o.navigation.state==="idle"){te(o.historyAction,o.location,{startUninterruptedRevalidation:!0});return}te(L||o.historyAction,o.navigation.location,{overrideNavigation:o.navigation})}}async function te(i,l,c){b&&b.abort(),b=null,L=i,T=(c&&c.startUninterruptedRevalidation)===!0,Lt(o.location,o.matches),E=(c&&c.preventScrollReset)===!0;let m=r||t,p=c&&c.overrideNavigation,w=me(m,l,e.basename);if(!w){let F=q(404,{pathname:l.pathname}),{matches:z,route:W}=et(m);xe(),se(l,{matches:z,loaderData:{},errors:{[W.id]:F}});return}if(br(o.location,l)&&!(c&&c.submission&&G(c.submission.formMethod))){se(l,{matches:w});return}b=new AbortController;let v=he(e.history,l,b.signal,c&&c.submission),D,g;if(c&&c.pendingError)g={[oe(w).route.id]:c.pendingError};else if(c&&c.submission&&G(c.submission.formMethod)){let F=await Rt(v,l,c.submission,w,{replace:c.replace});if(F.shortCircuited)return;D=F.pendingActionData,g=F.pendingActionError,p=P({state:"loading",location:l},c.submission),v=new Request(v.url,{signal:v.signal})}let{shortCircuited:k,loaderData:S,errors:K}=await Dt(v,l,w,p,c&&c.submission,c&&c.replace,D,g);k||(b=null,se(l,P({matches:w},D?{actionData:D}:{},{loaderData:S,errors:K})))}async function Rt(i,l,c,m,p){Se();let w=P({state:"submitting",location:l},c);j({navigation:w});let v,D=Oe(m,l);if(!D.route.action)v={type:_.error,error:q(405,{method:i.method,pathname:l.pathname,routeId:D.route.id})};else if(v=await fe("action",i,D,m,M.basename),i.signal.aborted)return{shortCircuited:!0};if(le(v)){let g;return p&&p.replace!=null?g=p.replace:g=v.location===o.location.pathname+o.location.search,await de(o,v,{submission:c,replace:g}),{shortCircuited:!0}}if(ge(v)){let g=oe(m,D.route.id);return(p&&p.replace)!==!0&&(L=O.Push),{pendingActionData:{},pendingActionError:{[g.route.id]:v.error}}}if(ne(v))throw q(400,{type:"defer-action"});return{pendingActionData:{[D.route.id]:v.data}}}async function Dt(i,l,c,m,p,w,v,D){let g=m;g||(g=P({state:"loading",location:l,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0},p));let k=p||(g.formMethod&&g.formAction&&g.formData&&g.formEncType?{formMethod:g.formMethod,formAction:g.formAction,formData:g.formData,formEncType:g.formEncType}:void 0),S=r||t,[K,F]=Je(e.history,o,c,k,l,A,N,C,J,S,e.basename,v,D);if(xe(I=>!(c&&c.some(V=>V.route.id===I))||K&&K.some(V=>V.route.id===I)),K.length===0&&F.length===0)return se(l,P({matches:c,loaderData:{},errors:D||null},v?{actionData:v}:{})),{shortCircuited:!0};if(!T){F.forEach(V=>{let re=o.fetchers.get(V.key),Me={state:"loading",data:re&&re.data,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0," _hasFetcherDoneAnything ":!0};o.fetchers.set(V.key,Me)});let I=v||o.actionData;j(P({navigation:g},I?Object.keys(I).length===0?{actionData:null}:{actionData:I}:{},F.length>0?{fetchers:new Map(o.fetchers)}:{}))}B=++H,F.forEach(I=>R.set(I.key,b));let{results:z,loaderResults:W,fetcherResults:ue}=await Ie(o.matches,c,K,F,i);if(i.signal.aborted)return{shortCircuited:!0};F.forEach(I=>R.delete(I.key));let Re=tt(z);if(Re)return await de(o,Re,{replace:w}),{shortCircuited:!0};let{loaderData:De,errors:ie}=Qe(o,c,K,W,D,F,ue,ee);ee.forEach((I,V)=>{I.subscribe(re=>{(re||I.done)&&ee.delete(V)})}),Et();let Le=He(B);return P({loaderData:De,errors:ie},Le||F.length>0?{fetchers:new Map(o.fetchers)}:{})}function ke(i){return o.fetchers.get(i)||hr}function Mt(i,l,c,m){if(mr)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");R.has(i)&&be(i);let w=me(r||t,c,e.basename);if(!w){Ee(i,l,q(404,{pathname:c}));return}let{path:v,submission:D}=Ge(c,m,!0),g=Oe(w,v);if(E=(m&&m.preventScrollReset)===!0,D&&G(D.formMethod)){Pt(i,l,v,g,w,D);return}J.set(i,{routeId:l,path:v}),St(i,l,v,g,w,D)}async function Pt(i,l,c,m,p,w){if(Se(),J.delete(i),!m.route.action){let Y=q(405,{method:w.formMethod,pathname:c,routeId:l});Ee(i,l,Y);return}let v=o.fetchers.get(i),D=P({state:"submitting"},w,{data:v&&v.data," _hasFetcherDoneAnything ":!0});o.fetchers.set(i,D),j({fetchers:new Map(o.fetchers)});let g=new AbortController,k=he(e.history,c,g.signal,w);R.set(i,g);let S=await fe("action",k,m,p,M.basename);if(k.signal.aborted){R.get(i)===g&&R.delete(i);return}if(le(S)){R.delete(i),Z.add(i);let Y=P({state:"loading"},w,{data:void 0," _hasFetcherDoneAnything ":!0});return o.fetchers.set(i,Y),j({fetchers:new Map(o.fetchers)}),de(o,S,{isFetchActionRedirect:!0})}if(ge(S)){Ee(i,l,S.error);return}if(ne(S))throw q(400,{type:"defer-action"});let K=o.navigation.location||o.location,F=he(e.history,K,g.signal),z=r||t,W=o.navigation.state!=="idle"?me(z,o.navigation.location,e.basename):o.matches;U(W,"Didn't find any matches after fetcher action");let ue=++H;$.set(i,ue);let Re=P({state:"loading",data:S.data},w,{" _hasFetcherDoneAnything ":!0});o.fetchers.set(i,Re);let[De,ie]=Je(e.history,o,W,w,K,A,N,C,J,z,e.basename,{[m.route.id]:S.data},void 0);ie.filter(Y=>Y.key!==i).forEach(Y=>{let Te=Y.key,Be=o.fetchers.get(Te),Ft={state:"loading",data:Be&&Be.data,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0," _hasFetcherDoneAnything ":!0};o.fetchers.set(Te,Ft),R.set(Te,g)}),j({fetchers:new Map(o.fetchers)});let{results:Le,loaderResults:I,fetcherResults:V}=await Ie(o.matches,W,De,ie,F);if(g.signal.aborted)return;$.delete(i),R.delete(i),ie.forEach(Y=>R.delete(Y.key));let re=tt(Le);if(re)return de(o,re);let{loaderData:Me,errors:Ue}=Qe(o,o.matches,De,I,void 0,ie,V,ee),Tt={state:"idle",data:S.data,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0," _hasFetcherDoneAnything ":!0};o.fetchers.set(i,Tt);let Ct=He(ue);o.navigation.state==="loading"&&ue>B?(U(L,"Expected pending action"),b&&b.abort(),se(o.navigation.location,{matches:W,loaderData:Me,errors:Ue,fetchers:new Map(o.fetchers)})):(j(P({errors:Ue,loaderData:Ze(o.loaderData,Me,W,Ue)},Ct?{fetchers:new Map(o.fetchers)}:{})),A=!1)}async function St(i,l,c,m,p,w){let v=o.fetchers.get(i),D=P({state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0},w,{data:v&&v.data," _hasFetcherDoneAnything ":!0});o.fetchers.set(i,D),j({fetchers:new Map(o.fetchers)});let g=new AbortController,k=he(e.history,c,g.signal);R.set(i,g);let S=await fe("loader",k,m,p,M.basename);if(ne(S)&&(S=await pt(S,k.signal,!0)||S),R.get(i)===g&&R.delete(i),k.signal.aborted)return;if(le(S)){await de(o,S);return}if(ge(S)){let F=oe(o.matches,l);o.fetchers.delete(i),j({fetchers:new Map(o.fetchers),errors:{[F.route.id]:S.error}});return}U(!ne(S),"Unhandled fetcher deferred data");let K={state:"idle",data:S.data,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0," _hasFetcherDoneAnything ":!0};o.fetchers.set(i,K),j({fetchers:new Map(o.fetchers)})}async function de(i,l,c){var m;let{submission:p,replace:w,isFetchActionRedirect:v}=c===void 0?{}:c;l.revalidate&&(A=!0);let D=ye(i.location,l.location,P({_isRedirect:!0},v?{_isFetchActionRedirect:!0}:{}));if(U(D,"Expected a location on the redirect navigation"),ct.test(l.location)&&ut&&typeof((m=window)==null?void 0:m.location)<"u"){let z=e.history.createURL(l.location),W=_e(z.pathname,e.basename||"/")==null;if(window.location.origin!==z.origin||W){w?window.location.replace(l.location):window.location.assign(l.location);return}}b=null;let g=w===!0?O.Replace:O.Push,{formMethod:k,formAction:S,formEncType:K,formData:F}=i.navigation;!p&&k&&S&&F&&K&&(p={formMethod:k,formAction:S,formEncType:K,formData:F}),fr.has(l.status)&&p&&G(p.formMethod)?await te(g,D,{submission:P({},p,{formAction:l.location}),preventScrollReset:E}):await te(g,D,{overrideNavigation:{state:"loading",location:D,formMethod:p?p.formMethod:void 0,formAction:p?p.formAction:void 0,formEncType:p?p.formEncType:void 0,formData:p?p.formData:void 0},preventScrollReset:E})}async function Ie(i,l,c,m,p){let w=await Promise.all([...c.map(g=>fe("loader",p,g,l,M.basename)),...m.map(g=>g.matches&&g.match?fe("loader",he(e.history,g.path,p.signal),g.match,g.matches,M.basename):{type:_.error,error:q(404,{pathname:g.path})})]),v=w.slice(0,c.length),D=w.slice(c.length);return await Promise.all([rt(i,c,v,p.signal,!1,o.loaderData),rt(i,m.map(g=>g.match),D,p.signal,!0)]),{results:w,loaderResults:v,fetcherResults:D}}function Se(){A=!0,N.push(...xe()),J.forEach((i,l)=>{R.has(l)&&(C.push(l),be(l))})}function Ee(i,l,c){let m=oe(o.matches,l);Ae(i),j({errors:{[m.route.id]:c},fetchers:new Map(o.fetchers)})}function Ae(i){R.has(i)&&be(i),J.delete(i),$.delete(i),Z.delete(i),o.fetchers.delete(i)}function be(i){let l=R.get(i);U(l,"Expected fetch controller: "+i),l.abort(),R.delete(i)}function Ne(i){for(let l of i){let m={state:"idle",data:ke(l).data,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0," _hasFetcherDoneAnything ":!0};o.fetchers.set(l,m)}}function Et(){let i=[];for(let l of Z){let c=o.fetchers.get(l);U(c,"Expected fetcher: "+l),c.state==="loading"&&(Z.delete(l),i.push(l))}Ne(i)}function He(i){let l=[];for(let[c,m]of $)if(m<i){let p=o.fetchers.get(c);U(p,"Expected fetcher: "+c),p.state==="loading"&&(be(c),$.delete(c),l.push(c))}return Ne(l),l.length>0}function At(i,l){let c=o.blockers.get(i)||qe;return X.get(i)!==l&&X.set(i,l),c}function ce(i){o.blockers.delete(i),X.delete(i)}function we(i,l){let c=o.blockers.get(i)||qe;U(c.state==="unblocked"&&l.state==="blocked"||c.state==="blocked"&&l.state==="blocked"||c.state==="blocked"&&l.state==="proceeding"||c.state==="blocked"&&l.state==="unblocked"||c.state==="proceeding"&&l.state==="unblocked","Invalid blocker state transition: "+c.state+" -> "+l.state),o.blockers.set(i,l),j({blockers:new Map(o.blockers)})}function Ke(i){let{currentLocation:l,nextLocation:c,historyAction:m}=i;if(X.size===0)return;X.size>1&&ve(!1,"A router only supports one blocker at a time");let p=Array.from(X.entries()),[w,v]=p[p.length-1],D=o.blockers.get(w);if(!(D&&D.state==="proceeding")&&v({currentLocation:l,nextLocation:c,historyAction:m}))return w}function xe(i){let l=[];return ee.forEach((c,m)=>{(!i||i(m))&&(c.cancel(),l.push(m),ee.delete(m))}),l}function xt(i,l,c){if(s=i,u=l,d=c||(m=>m.key),!h&&o.navigation===Fe){h=!0;let m=$e(o.location,o.matches);m!=null&&j({restoreScrollPosition:m})}return()=>{s=null,u=null,d=null}}function Lt(i,l){if(s&&d&&u){let c=l.map(p=>nt(p,o.loaderData)),m=d(i,c)||i.key;s[m]=u()}}function $e(i,l){if(s&&d&&u){let c=l.map(w=>nt(w,o.loaderData)),m=d(i,c)||i.key,p=s[m];if(typeof p=="number")return p}return null}function Ut(i){r=i}return M={get basename(){return e.basename},get state(){return o},get routes(){return t},initialize:yt,subscribe:bt,enableScrollRestoration:xt,navigate:je,fetch:Mt,revalidate:wt,createHref:i=>e.history.createHref(i),encodeLocation:i=>e.history.encodeLocation(i),getFetcher:ke,deleteFetcher:Ae,dispose:vt,getBlocker:At,deleteBlocker:ce,_internalFetchControllers:R,_internalActiveDeferreds:ee,_internalSetRoutes:Ut},M}function pr(e){return e!=null&&"formData"in e}function Ge(e,t,r){r===void 0&&(r=!1);let n=typeof e=="string"?e:ae(e);if(!t||!pr(t))return{path:n};if(t.formMethod&&!Rr(t.formMethod))return{path:n,error:q(405,{method:t.formMethod})};let a;if(t.formData&&(a={formMethod:t.formMethod||"get",formAction:mt(n),formEncType:t&&t.formEncType||"application/x-www-form-urlencoded",formData:t.formData},G(a.formMethod)))return{path:n,submission:a};let s=Q(n),d=ht(t.formData);return r&&s.search&&gt(s.search)&&d.append("index",""),s.search="?"+d,{path:ae(s),submission:a}}function gr(e,t){let r=e;if(t){let n=e.findIndex(a=>a.route.id===t);n>=0&&(r=e.slice(0,n))}return r}function Je(e,t,r,n,a,s,d,u,h,f,y,x,M){let o=M?Object.values(M)[0]:x?Object.values(x)[0]:void 0,L=e.createURL(t.location),E=e.createURL(a),b=s||L.toString()===E.toString()||L.search!==E.search,T=M?Object.keys(M)[0]:void 0,N=gr(r,T).filter((R,H)=>{if(R.route.loader==null)return!1;if(yr(t.loaderData,t.matches[H],R)||d.some(Z=>Z===R.route.id))return!0;let B=t.matches[H],$=R;return Xe(R,P({currentUrl:L,currentParams:B.params,nextUrl:E,nextParams:$.params},n,{actionResult:o,defaultShouldRevalidate:b||ft(B,$)}))}),C=[];return h.forEach((R,H)=>{if(!r.some(J=>J.route.id===R.routeId))return;let B=me(f,R.path,y);if(!B){C.push(P({key:H},R,{matches:null,match:null}));return}let $=Oe(B,R.path);if(u.includes(H)){C.push(P({key:H,matches:B,match:$},R));return}Xe($,P({currentUrl:L,currentParams:t.matches[t.matches.length-1].params,nextUrl:E,nextParams:r[r.length-1].params},n,{actionResult:o,defaultShouldRevalidate:b}))&&C.push(P({key:H,matches:B,match:$},R))}),[N,C]}function yr(e,t,r){let n=!t||r.route.id!==t.route.id,a=e[r.route.id]===void 0;return n||a}function ft(e,t){let r=e.route.path;return e.pathname!==t.pathname||r!=null&&r.endsWith("*")&&e.params["*"]!==t.params["*"]}function Xe(e,t){if(e.route.shouldRevalidate){let r=e.route.shouldRevalidate(t);if(typeof r=="boolean")return r}return t.defaultShouldRevalidate}async function fe(e,t,r,n,a,s,d,u){a===void 0&&(a="/"),s===void 0&&(s=!1),d===void 0&&(d=!1);let h,f,y,x=new Promise((E,b)=>y=b),M=()=>y();t.signal.addEventListener("abort",M);try{let E=r.route[e];U(E,"Could not find the "+e+' to run on the "'+r.route.id+'" route'),f=await Promise.race([E({request:t,params:r.params,context:u}),x]),U(f!==void 0,"You defined "+(e==="action"?"an action":"a loader")+" for route "+('"'+r.route.id+"\" but didn't return anything from your `"+e+"` ")+"function. Please return a value or `null`.")}catch(E){h=_.error,f=E}finally{t.signal.removeEventListener("abort",M)}if(wr(f)){let E=f.status;if(ur.has(E)){let A=f.headers.get("Location");if(U(A,"Redirects returned/thrown from loaders/actions must have a Location header"),ct.test(A)){if(!s){let N=new URL(t.url),C=A.startsWith("//")?new URL(N.protocol+A):new URL(A),R=_e(C.pathname,a)!=null;C.origin===N.origin&&R&&(A=C.pathname+C.search+C.hash)}}else{let N=n.slice(0,n.indexOf(r)+1),C=lt(N).map(H=>H.pathnameBase),R=er(A,C,new URL(t.url).pathname);if(U(ae(R),"Unable to resolve redirect location: "+A),a){let H=R.pathname;R.pathname=H==="/"?a:pe([a,H])}A=ae(R)}if(s)throw f.headers.set("Location",A),f;return{type:_.redirect,status:E,location:A,revalidate:f.headers.get("X-Remix-Revalidate")!==null}}if(d)throw{type:h||_.data,response:f};let b,T=f.headers.get("Content-Type");return T&&/\bapplication\/json\b/.test(T)?b=await f.json():b=await f.text(),h===_.error?{type:h,error:new st(E,f.statusText,b),headers:f.headers}:{type:_.data,data:b,statusCode:f.status,headers:f.headers}}if(h===_.error)return{type:h,error:f};if(f instanceof ar){var o,L;return{type:_.deferred,deferredData:f,statusCode:(o=f.init)==null?void 0:o.status,headers:((L=f.init)==null?void 0:L.headers)&&new Headers(f.init.headers)}}return{type:_.data,data:f}}function he(e,t,r,n){let a=e.createURL(mt(t)).toString(),s={signal:r};if(n&&G(n.formMethod)){let{formMethod:d,formEncType:u,formData:h}=n;s.method=d.toUpperCase(),s.body=u==="application/x-www-form-urlencoded"?ht(h):h}return new Request(a,s)}function ht(e){let t=new URLSearchParams;for(let[r,n]of e.entries())t.append(r,n instanceof File?n.name:n);return t}function vr(e,t,r,n,a){let s={},d=null,u,h=!1,f={};return r.forEach((y,x)=>{let M=t[x].route.id;if(U(!le(y),"Cannot handle redirect results in processLoaderData"),ge(y)){let o=oe(e,M),L=y.error;n&&(L=Object.values(n)[0],n=void 0),d=d||{},d[o.route.id]==null&&(d[o.route.id]=L),s[M]=void 0,h||(h=!0,u=lr(y.error)?y.error.status:500),y.headers&&(f[M]=y.headers)}else ne(y)?(a.set(M,y.deferredData),s[M]=y.deferredData.data):s[M]=y.data,y.statusCode!=null&&y.statusCode!==200&&!h&&(u=y.statusCode),y.headers&&(f[M]=y.headers)}),n&&(d=n,s[Object.keys(n)[0]]=void 0),{loaderData:s,errors:d,statusCode:u||200,loaderHeaders:f}}function Qe(e,t,r,n,a,s,d,u){let{loaderData:h,errors:f}=vr(t,r,n,a,u);for(let y=0;y<s.length;y++){let{key:x,match:M}=s[y];U(d!==void 0&&d[y]!==void 0,"Did not find corresponding fetcher result");let o=d[y];if(ge(o)){let L=oe(e.matches,M==null?void 0:M.route.id);f&&f[L.route.id]||(f=P({},f,{[L.route.id]:o.error})),e.fetchers.delete(x)}else if(le(o))U(!1,"Unhandled fetcher revalidation redirect");else if(ne(o))U(!1,"Unhandled fetcher deferred data");else{let L={state:"idle",data:o.data,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0," _hasFetcherDoneAnything ":!0};e.fetchers.set(x,L)}}return{loaderData:h,errors:f}}function Ze(e,t,r,n){let a=P({},t);for(let s of r){let d=s.route.id;if(t.hasOwnProperty(d)?t[d]!==void 0&&(a[d]=t[d]):e[d]!==void 0&&s.route.loader&&(a[d]=e[d]),n&&n.hasOwnProperty(d))break}return a}function oe(e,t){return(t?e.slice(0,e.findIndex(n=>n.route.id===t)+1):[...e]).reverse().find(n=>n.route.hasErrorBoundary===!0)||e[0]}function et(e){let t=e.find(r=>r.index||!r.path||r.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:t}],route:t}}function q(e,t){let{pathname:r,routeId:n,method:a,type:s}=t===void 0?{}:t,d="Unknown Server Error",u="Unknown @remix-run/router error";return e===400?(d="Bad Request",a&&r&&n?u="You made a "+a+' request to "'+r+'" but '+('did not provide a `loader` for route "'+n+'", ')+"so there is no way to handle the request.":s==="defer-action"&&(u="defer() is not supported in actions")):e===403?(d="Forbidden",u='Route "'+n+'" does not match URL "'+r+'"'):e===404?(d="Not Found",u='No route matches URL "'+r+'"'):e===405&&(d="Method Not Allowed",a&&r&&n?u="You made a "+a.toUpperCase()+' request to "'+r+'" but '+('did not provide an `action` for route "'+n+'", ')+"so there is no way to handle the request.":a&&(u='Invalid request method "'+a.toUpperCase()+'"')),new st(e||500,d,new Error(u),!0)}function tt(e){for(let t=e.length-1;t>=0;t--){let r=e[t];if(le(r))return r}}function mt(e){let t=typeof e=="string"?Q(e):e;return ae(P({},t,{hash:""}))}function br(e,t){return e.pathname===t.pathname&&e.search===t.search&&e.hash!==t.hash}function ne(e){return e.type===_.deferred}function ge(e){return e.type===_.error}function le(e){return(e&&e.type)===_.redirect}function wr(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.headers=="object"&&typeof e.body<"u"}function Rr(e){return cr.has(e)}function G(e){return sr.has(e)}async function rt(e,t,r,n,a,s){for(let d=0;d<r.length;d++){let u=r[d],h=t[d];if(!h)continue;let f=e.find(x=>x.route.id===h.route.id),y=f!=null&&!ft(f,h)&&(s&&s[h.route.id])!==void 0;ne(u)&&(a||y)&&await pt(u,n,a).then(x=>{x&&(r[d]=x||r[d])})}}async function pt(e,t,r){if(r===void 0&&(r=!1),!await e.deferredData.resolveData(t)){if(r)try{return{type:_.data,data:e.deferredData.unwrappedData}}catch(a){return{type:_.error,error:a}}return{type:_.data,data:e.deferredData.data}}}function gt(e){return new URLSearchParams(e).getAll("index").some(t=>t==="")}function nt(e,t){let{route:r,pathname:n,params:a}=e;return{id:r.id,pathname:n,params:a,data:t[r.id],handle:r.handle}}function Oe(e,t){let r=typeof t=="string"?Q(t).search:t.search;if(e[e.length-1].route.index&&gt(r||""))return e[e.length-1];let n=lt(e);return n[n.length-1]}export{O as A,st as E,lr as a,Dr as b,Mr as c,U as i,pe as j,me as m,Q as p,_e as s};
