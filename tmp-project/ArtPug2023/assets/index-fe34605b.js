var tt=Object.defineProperty;var nt=(n,t,s)=>t in n?tt(n,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[t]=s;var X=(n,t,s)=>(nt(n,typeof t!="symbol"?t+"":t,s),s),Ne=(n,t,s)=>{if(!t.has(n))throw TypeError("Cannot "+s)};var g=(n,t,s)=>(Ne(n,t,"read from private field"),s?s.call(n):t.get(n)),ue=(n,t,s)=>{if(t.has(n))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(n):t.set(n,s)},V=(n,t,s,o)=>(Ne(n,t,"write to private field"),o?o.call(n,s):t.set(n,s),s);import{j as e,C as Ie,B as ze,T as d,a as i,F as Q,L as ee,I as W,M as st,b as ot,c as rt,d as it,e as Pe,E as at,S as ct,f as R,H as I,g as lt,h as _e,V as k,i as He,k as _,l as pe,m as fe,N as dt,n as ht,o as ut,p as gt,q as pt,r as te,s as xe,t as L,u as We,v as oe,w as re,x as ie,y as ae,z as ce,A as ft,D as mt,G as Te,J as Ae,K as J,O as Ct,P as wt,Q as Be,R as bt,U as yt,W as Ee,X as Et}from"./@chakra-ui-c1d19ede.js";import{r as c}from"./react-5d4b96d5.js";import{c as St}from"./react-dom-d3795ed8.js";import{W as vt,f as ke,J as It,C as xt,p as Fe}from"./@ethersproject-bc00b28a.js";import{u as me,O as Tt,a as Ue,b as At,c as kt,R as Ot,N as Mt}from"./react-router-d0b48985.js";import{c as Dt}from"./react-router-dom-0617cbc6.js";import{M as Ye,a as je,b as Nt,c as Pt}from"./react-icons-4ec5e543.js";import"./lodash.mergewith-953df044.js";import"./aes-js-87174ba5.js";import"./@emotion-a09d463e.js";import"./hoist-non-react-statics-d23de475.js";import"./react-is-3e8633c1.js";import"./@babel-387d1bfb.js";import"./stylis-581c9ed0.js";import"./color2k-69f3754e.js";import"./framer-motion-969ba4fe.js";import"./hey-listen-f307a282.js";import"./@popperjs-0e7ee0a2.js";import"./react-focus-lock-8d603c90.js";import"./focus-lock-1f5948c4.js";import"./use-sidecar-665c7840.js";import"./tslib-c672c11e.js";import"./use-callback-ref-4e76fd9d.js";import"./react-clientside-effect-d9c4c9b2.js";import"./react-remove-scroll-2b0d6b16.js";import"./react-remove-scroll-bar-c133f150.js";import"./react-style-singleton-94a4ca86.js";import"./get-nonce-3d5abfe4.js";import"./aria-hidden-72cb0184.js";import"./react-fast-compare-8dea2db9.js";import"./scheduler-04ce0582.js";import"./js-sha3-adef5cb2.js";import"./bn.js-a6bfc557.js";import"./hash.js-79a51ccc.js";import"./minimalistic-assert-7cc78341.js";import"./inherits-13d20712.js";import"./bech32-b26490c1.js";import"./@remix-run-bb1230c9.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function s(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerpolicy&&(a.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?a.credentials="include":r.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(r){if(r.ep)return;r.ep=!0;const a=s(r);fetch(r.href,a)}})();const G={IS_CONNECTED:"isConnected"},Re=11155111,ge={account:{},signer:{},connected:!1,equalToOwner:function(n){return this.account.toLowerCase()==n.toLowerCase()}};function Oe(n){return n.slice(0,6)+"..."+n.slice(-4)}var S;class Ft{constructor(){ue(this,S,ge);X(this,"isProviderConnectedToSupportedChain",!1);X(this,"onAccountUpdate",t=>{})}async initAndConnect(t){typeof window.ethereum<"u"&&window.ethereum.isMetaMask&&(this.onAccountUpdate=t,window.ethereum.on("accountsChanged",s=>{this.onAccountChanged(s)}),window.ethereum.on("chainChanged",s=>{this.onChainIdChanged(s)}),window.ethereum._state.accounts!=null&&window.ethereum._state.accounts.length>0&&sessionStorage.getItem(G.IS_CONNECTED)=="true"&&await this.connectWallet())}async onAccountChanged(t){if(t[0]==null)sessionStorage.setItem(G.IS_CONNECTED,!1),this.isAccountConnected=!1,V(this,S,{...g(this,S),connected:!1,account:{},signer:{}});else{sessionStorage.setItem(G.IS_CONNECTED,!0);const s=await this.getSigner(t[0]);V(this,S,{...g(this,S),connected:!0,account:t[0],signer:s})}this.onAccountUpdate(g(this,S))}async onChainIdChanged(t){this.isProviderConnectedToSupportedChain=t==Re;const s=await this.getSigner(g(this,S).account);V(this,S,{...g(this,S),signer:s}),this.onAccountUpdate(g(this,S))}async getSigner(t){return Object.keys(t).length>0?await new vt(window.ethereum).getSigner(t):{}}async connectWallet(){console.log("Try to connect a metamask wallet"),(typeof window.ethereum>"u"||!window.ethereum.isMetaMask)&&alert("Only the metamask application is supported at the moment, please install it to continue.");try{const t=await window.ethereum.request({method:"eth_requestAccounts"}),s=await window.ethereum.request({method:"eth_chainId"});this.isProviderConnectedToSupportedChain=s==Re,sessionStorage.setItem(G.IS_CONNECTED,!0),V(this,S,{...g(this,S),connected:!0,account:t[0],signer:await this.getSigner(t[0])})}catch(t){sessionStorage.setItem(G.IS_CONNECTED,!1),V(this,S,ge),console.log("Fail to connect an account with error: "+t)}finally{this.onAccountUpdate(g(this,S))}}async switchToEthereum(){this.isProviderConnectedToSupportedChain?console.log("No need to switch the sepolia network, current chain id: "+g(this,S).chainId):await window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:"0xAA36A7"}]})}async logout(){console.log("Unregister the connected account"),sessionStorage.setItem(G.IS_CONNECTED,!1),V(this,S,{...g(this,S),connected:!1,account:{},signer:{}}),this.onAccountUpdate(g(this,S))}}S=new WeakMap;const K=new Ft;function z({text:n,onClick:t,color:s,inProgress:o,width:r}){return o?e(Ie,{alignSelf:"center",isIndeterminate:!0,size:8,color:"rgb(212,136,155, 1)"}):e(ze,{colorScheme:s,variant:"outline",onClick:t,width:r,children:e(d,{textTransform:"uppercase",fw:"bold",fs:"0.8em",children:n})})}function qe({accountData:n}){const t=me();async function s(){t("/contests/mine",{relative:!1})}async function o(){K.connectWallet()}async function r(){K.logout()}return i(Q,{as:"nav",align:"center",justify:"space-between",wrap:"wrap",w:"100%",mb:8,ps:16,pe:16,bg:["primary.500","primary.500","transparent","transparent"],color:["white","white","primary.700","primary.700"],children:[e(ee,{bg:"transparent",color:"white",p:5,href:"/tmp-project/ArtPug2023/",_hover:{borderBottomWidth:0},children:e(W,{src:"/tmp-project/ArtPug2023/res/logo.png",alt:"ArtPug logo",boxSize:82,position:"relative"})}),n.connected?i(st,{children:[e(ot,{as:ze,rightIcon:e(rt,{}),children:e(d,{fontWeight:"bold",fontSize:"0.8em",children:Oe(n.account)})}),i(it,{children:[i(Pe,{onClick:s,children:[e(at,{me:2}),e(d,{textTransform:"uppercase",fontWeight:"bold",fontSize:"0.8em",children:"MY CONTESTS"})]}),i(Pe,{onClick:r,children:[e(ct,{me:2}),e(d,{textTransform:"uppercase",fontWeight:"bold",fontSize:"0.8em",children:"LOGOUT"})]})]})]}):e(z,{text:"CONNECT",onClick:o,color:"pink"})]})}function Rt(){const[n,t]=c.useState(ge);return c.useEffect(()=>{K.initAndConnect(s=>{t(s)})},[]),i(R,{w:"100vw",children:[e(qe,{accountData:n}),e(Tt,{context:[n,t]})]})}const Le=()=>new Date(Date.now()+3600*1e3*24),Lt=()=>new Date(Date.now()+3600*1e3*24*2),ne=n=>new Date(n.toNumber()*1e3),Ge=n=>{var t=Math.abs(n-new Date)/1e3,s=Math.floor(t/86400);t-=s*86400;var o=Math.floor(t/3600)%24;t-=o*3600;var r=Math.floor(t/60)%60;t-=r*60;var a=Math.ceil(t%60);return s>0?s+"d "+o+"h":o>0?o+"h "+r+"m":r>0?r+"m "+a+"s":a+"s"};function Vt({isOver:n,endDate:t}){return n?e(I,{width:"100%",position:"absolute","z-index":"3",alignContent:"end",justifyContent:"end",paddingEnd:"8px",paddingTop:"8px",children:e(lt,{})}):i(I,{width:"100%",position:"absolute","z-index":"3",alignContent:"end",justifyContent:"end",paddingEnd:"8px",paddingTop:"8px",children:[e(_e,{}),e(d,{fontSize:"1em",children:Ge(t)})]})}function zt({contest:n}){const t=me(),s="SEE MORE | "+ke(n.reward)+"Ξ PRIZE",o="SEE RESULTS",r=ne(n.endDate),a=n.ended||r<new Date;async function l(){console.log("The contest with the id: "+n.id+" has been selected."),t("/contest/"+n.id,{relative:!1})}return e(Q,{height:"215px",role:"group",overflow:"hidden",sx:{borderRadius:"8px"},className:"card",children:i(R,{width:"100%","z-index":"1",position:"relative",onClick:l,children:[e(W,{src:n.banner,objectFit:"cover",width:"100%",height:"100%",opacity:1,position:"absolute",transition:"0.5s ease"}),i(k,{position:"absolute",bg:"rgba(0, 0, 0, 0.7)","z-index":"2",width:"100%",height:"100%",alignItems:"center",justifyContent:"center",children:[e(d,{noOfLines:2,ps:1,pe:1,textTransform:"uppercase",fontWeight:"bold",textAlign:"center",fontSize:"1em",children:n.title}),e(z,{text:a?o:s,color:"pink"})]}),e(Vt,{isOver:a,endDate:r})]})},n.id)}function _t(){return i(k,{children:[e(d,{children:"Come back later..."}),e(d,{children:"No contest has been closed yet."})]})}function Ht(){return i(k,{children:[e(d,{children:"Come back later..."}),e(d,{children:"There are no contests running at the moment."})]})}function Wt({isConnected:n}){return n?i(k,{children:[e(d,{children:"You never created a contest."}),e(d,{children:'Give it a try and click on the "Create Contest" button.'})]}):e(d,{children:"You must connect your wallet to be able to see this page."})}const F=Object.freeze({Join:1,Closed:2,Mine:3});function Bt({pageType:n}){const t=me();async function s(){t("/contests/ended",{relative:!1})}async function o(){t("/contests/join",{relative:!1})}async function r(){t("/contests/mine",{relative:!1})}return e(R,{paddingBottom:8,children:i(I,{spacing:16,alignItems:"center",justifyContent:"center",children:[e(ee,{_focus:{boxShadow:"none"},_hover:{textDecoration:"none"},className:n==F.Join?"active":"inactive",onClick:o,children:"JOIN"}),e(ee,{_focus:{boxShadow:"none"},_hover:{textDecoration:"none"},className:n==F.Closed?"active":"inactive",onClick:s,children:"ENDED"}),e(ee,{_focus:{boxShadow:"none"},_hover:{textDecoration:"none"},className:n==F.Mine?"active":"inactive",onClick:r,children:"MINE"})]})})}function Ut({type:n,contests:t,isConnected:s}){function o(r){switch(r){case F.Join:return e(Ht,{});case F.Closed:return e(_t,{});default:return e(Wt,{isConnected:s})}}return t.length>0?e(He,{w:"100%",columns:[1,2,3],spacing:8,maxWidth:"1170px",children:t.map((r,a)=>e(zt,{contest:r},a))}):o(n)}function Je(){return i(He,{w:"100%",columns:[1,2,3],spacing:24,maxWidth:"1170px",children:[e(_,{width:"100%",height:"215px",overflow:"hidden",sx:{borderRadius:"8px"}}),e(_,{width:"100%",height:"215px",overflow:"hidden",sx:{borderRadius:"8px"}}),e(_,{width:"100%",height:"215px",overflow:"hidden",sx:{borderRadius:"8px"}}),e(_,{width:"100%",height:"215px",overflow:"hidden",sx:{borderRadius:"8px"}}),e(_,{width:"100%",height:"215px",overflow:"hidden",sx:{borderRadius:"8px"}}),e(_,{width:"100%",height:"215px",overflow:"hidden",sx:{borderRadius:"8px"}})]})}function Yt({value:n,title:t,help:s,onChange:o}){return i(pe,{children:[e(fe,{children:t}),i(dt,{min:0,max:1,precision:3,step:.002,value:n,onChange:o,children:[e(ht,{}),i(ut,{children:[e(gt,{}),e(pt,{})]})]}),e(te,{children:s})]})}function Ke({title:n,placeholder:t,help:s,value:o,onChange:r,isValid:a}){return i(pe,{isInvalid:!a,children:[e(fe,{children:n}),e(xe,{placeholder:t,value:o,onChange:r}),e(te,{children:s})]})}function jt({title:n,help:t,value:s,onChange:o,isValid:r}){return i(pe,{isInvalid:!r,children:[e(fe,{children:n}),e(xe,{type:"datetime-local",value:s,onChange:o}),e(te,{children:t})]})}const se=n=>{var t=new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i");return!!t.test(n)};function $e({title:n,placeholder:t,help:s,value:o,onChange:r,isValid:a,full:l}){const[h,p]=c.useState(!1);return i(pe,{isInvalid:!a,children:[e(fe,{children:n}),e(xe,{placeholder:t,value:o,onChange:u=>{p(!1),r(u)}}),h?l?e(W,{src:o,mt:2,sx:{borderRadius:"8px"},objectFit:"cover",width:"100%",height:"100%",alt:"Image"}):i(R,{position:"relative",height:32,width:"100%",mt:2,children:[e(W,{src:o,objectFit:"cover",position:"absolute",width:"100%",height:32,alt:"Image"}),e(Q,{position:"absolute",bgGradient:"linear(to-b, rgba(0, 0, 0, 0.1), #2D3748)","z-index":"2",width:"100%",height:32})]}):se(o)?e(te,{color:"rgb(212,136,155, 1)",onClick:()=>p(!0),_hover:{fontWeight:"semibold",cursor:"pointer"},children:"Preview"}):e(te,{children:s})]})}function Ce({title:n,errorMessage:t}){const[s,o]=c.useState(!1);return t?i(k,{spacing:0,alignItems:"start",children:[e(d,{color:"rgb(212,136,155, 1)",children:n}),s?e(d,{color:"rgb(212,136,155, 1)",fontSize:"sm",children:t}):e(d,{color:"rgb(212,136,155, 1)",onClick:a=>o(!0),_hover:{fontWeight:"semibold"},cursor:"pointer",fontSize:"sm",children:"Show error details"})]}):e(L,{})}function qt({onCreateContest:n,errorMessage:t}){const[s,o]=c.useState(""),[r,a]=c.useState(""),[l,h]=c.useState(Lt().toISOString().slice(0,16)),[p,m]=c.useState("0.000"),[u,C]=c.useState(!0),[w,E]=c.useState(!0),[N,O]=c.useState(!0),[y,M]=c.useState(!1),T=b=>"Ξ "+b,f=b=>b.replace(/^\$/,""),H=b=>b.length>3&&b.length<=45,B=b=>{o(b.target.value),C(se(b.target.value))},U=b=>{E(H(b.target.value)),a(b.target.value)},Y=b=>{new Date(b.target.value)<Le()?O(!1):O(!0),O(!0),h(b.target.value)};function le(){const b=se(s),de=H(r),he=new Date(l)>Le();O(he),C(b),E(de),b&&de&&he&&(M(!0),n(s,r,l,p))}return c.useEffect(()=>{console.log("refresh? with: "+t),M(!1)},[t]),i(We,{spacing:4,children:[e($e,{title:"Banner",placeholder:"Enter the url of your banner image",help:"Enter a valid image url.",value:s,onChange:B,isValid:u}),e(Ke,{title:"Title",placeholder:"Enter a title",help:"Your title must be longer than 3 characters and shorter than 45 characters.",value:r,onChange:U,isValid:w}),e(jt,{title:"Select an end date",help:"The contest will start when created and must last at least one full day.",value:l,onChange:Y,isValid:N}),e(Yt,{title:"Entry Price",help:"Enter the entry price for your contests participants.",value:T(p),onChange:b=>m(f(b))}),e(Ce,{title:"Failed to create the contest:",errorMessage:t}),e(z,{text:"CREATE",onClick:le,color:"pink",inProgress:y})]})}function Gt({onCreateContest:n,errorMessage:t}){return i(oe,{children:[e(re,{children:"Create Contest"}),e(ie,{}),e(ae,{children:e(qt,{onCreateContest:n,errorMessage:t})}),e(ce,{})]})}const Se={PROVIDER_URL:"https://eth-sepolia.g.alchemy.com/v2/22x4iEn_5Oh-9wtGgoD1qn8SWu13RnsD",ADDRESS:"0x9305f73a9b803510851f9625D37C3B802ab20593",ABI:"/tmp-project/ArtPug2023/res/abis/ArtPugV1.json"},Jt={contest:{},entries:{},currentUserEntry:{},isOver:function(){return ne(this.contest.endDate)<=new Date},hasEntries:function(){return this.entries.length>0},nbEntries:function(){return this.entries.length},rewardInEth:function(){return ke(this.contest.reward)},isInactive:function(){return this.isCancelled||this.contest.ended},winner:{},entryPrice:{},isCancelled:!1};var A,P;class Kt{constructor(){ue(this,A,void 0);ue(this,P,[]);X(this,"onContestsUpdate",()=>{});X(this,"onEntriesUpdate",()=>{})}async loadContract(){if(g(this,A)!==void 0)return;const s=await(await fetch(Se.ABI)).text(),o=new It(Se.PROVIDER_URL);V(this,A,new xt(Se.ADDRESS,s,o))}async addNewContest(t){if(g(this,P)[t]===void 0){const s=await this.getContest(t);console.log("A new contest has been created: "+s),V(this,P,[...g(this,P),s]),this.onContestsUpdate()}}async updateContest(t){const s=await this.getContest(t);console.log(`A contest has been updated: ${s}`);const o=[...g(this,P)];o[t]=s,V(this,P,o),this.onContestsUpdate()}async contractPrice(){return await g(this,A).price()}async loadAllContests(){return g(this,P)[0]===void 0&&V(this,P,await g(this,A).getAllContests()),g(this,P)}async getAllRunningContests(){return(await this.loadAllContests()).filter(function(s){return!s.ended&&ne(s.endDate)>=new Date}).reverse()}async getAllEndedContests(){return(await this.loadAllContests()).filter(function(s){return s.ended||ne(s.endDate)<new Date}).reverse()}async getAllContestsOf(t){return(await this.loadAllContests()).filter(function(o){return t.equalToOwner(o.owner)}).reverse()}async createContest(t,s,o,r,m,l){Z(t);var h=(new Date().getTime()/1e3).toFixed(0),p=(r.getTime()/1e3).toFixed(0),m=Fe(m),u=Fe("0.01");const C=await g(this,A).price(),w=await g(this,A).connect(t.signer).createContest(s,o,h,p,m,u,{value:C.creation});return w.wait().then(E=>{const N=E.events[0].args.contestId;this.addNewContest(N),l(N)}),w.hash}async getContest(t){return await g(this,A).getContest(t)}async getWinningEntryFor(t){return await g(this,A).getWinningEntryFor(t)}async getEntriesFor(t){return await g(this,A).getEntriesFor(t)}async entryPriceFor(t){const s=await this.contractPrice(),o=t.price;return o.creation.add(o.participation).add(s.participation)}async addEntry(t,s,o,r,a){Z(t);const l=await this.entryPriceFor(s),h=await g(this,A).connect(t.signer).addEntry(s.id,o,r,{value:l});return h.wait().then(p=>{a(p.events[0].args.entryId)}),h.hash}async endContest(t,s,o){Z(t);const r=await g(this,A).connect(t.signer).endContest(s.id.toNumber());return r.wait().then(async a=>{const l=a.events[0].args.contestId;await this.updateContest(l),o(l)}),r.hash}async cancelContest(t,s,o){Z(t);const r=await g(this,A).connect(t.signer).cancelContest(s.id.toNumber());return r.wait().then(async a=>{const l=a.events[0].args.contestId;await this.updateContest(l),o(l)}),r.hash}async hasVotedFor(t,s){try{return await g(this,A).connect(t.signer).hasVotedFor(s.id)}catch{return!1}}async voteOn(t,s,o,r,a){Z(t);const l=await g(this,A).connect(t.signer).voteOn(s.id,o,r);return l.wait().then(h=>{a(h.events[0].args.contestId)}),l.hash}async getContestInfo(t){await this.loadAllContests();const s=g(this,P)[t],o=await this.getWinningEntryFor(t),r=await this.entryPriceFor(s);return{...Jt,contest:s,entryPrice:r,winner:o,isCancelled:o.owner==0&&s.ended}}async updateContestInfo(t){const s=await this.getContestInfo(t.contest.id),o=await this.getEntriesFor(t.contest.id);return{...s,entries:o}}async closeContestInfo(t){console.log("Close contest info");const s=g(this,P)[t.contest.id],o=await this.getWinningEntryFor(s.id);return{...t,contest:s,winner:o}}async cancelContestInfo(t){const s=g(this,P)[t.contest.id];return{...t,contest:s,isCancelled:!0}}async updateEntries(t){const s=await this.getEntriesFor(t.contest.id);return{...t,entries:s}}}A=new WeakMap,P=new WeakMap;const x=new Kt;function Z(n){if(!n.connected)throw new Error("Must be connected to execute this function")}function $t({toEther:n}){return i(oe,{children:[e(re,{children:"Wrong Network"}),e(ie,{}),e(ae,{children:"In order to interact with this app, please switch to Sepolia Network"}),e(ce,{children:e(z,{text:"Switch to Sepolia",onClick:n,color:"pink"})})]})}function Me({onClose:n,isOpen:t,modalContent:s}){async function o(){try{await K.switchToEthereum(),n()}catch{console.log("Unable to switch to sepolia chain.")}}return i(ft,{closeOnOverlayClick:!1,onClose:n,isOpen:t,children:[e(mt,{}),K.isProviderConnectedToSupportedChain?s:e($t,{toEther:o})]})}function Qt({message:n,txHash:t}){return i(k,{spacing:0,alignItems:"start",children:[e(d,{children:n}),e(ee,{_focus:{boxShadow:"none"},_hover:{textDecoration:"none"},className:"inactive",onClick:()=>{window.open("https://sepolia.etherscan.io/tx/"+t,"_blank","noreferrer")},children:"See the transaction."})]})}function $({message:n,txHash:t,inProgress:s,onClose:o}){return i(oe,{children:[e(re,{children:"Transaction status"}),e(ie,{}),e(ae,{children:e(Qt,{message:n,txHash:t})}),e(ce,{children:e(z,{text:"OK",onClick:o,inProgress:s,color:"pink"})})]})}const v=Object.freeze({NotStarted:1,InError:2,InTransaction:3,Done:4}),De=n=>n.reason?n.reason:n.message?n.message:new String(n);function Xt({contests:n,accountData:t}){const s=me(),o=Te(),[r,a]=c.useState(!1),[l,h]=c.useState(!1),[p,m]=c.useState(!0),[u,C]=c.useState({status:v.NotStarted}),{isOpen:w,onOpen:E,onClose:N}=Ae();c.useEffect(()=>{O()},[n,t]);async function O(){m(!0),h(!1),a(!1);for(var T=0;T<n.length;T++){const f=n[T];if(!f.ended){new Date(f.endDate.toNumber()*1e3)<new Date?h(!0):a(String(f.owner).toLowerCase()==String(t.account).toLowerCase());break}}m(!1)}async function y(T,f,H,B){try{const U=await x.createContest(t,f,T,new Date(H),B,Y=>{C({status:v.Done,contestId:Y}),o({title:"Your contest has been created!",position:"top-right",status:"success",isClosable:!0})});C({status:v.InTransaction,txHash:U})}catch(U){M(U)}}function M(T){const f=De(T);console.log("Failed to create a contest with error: "+f),C({status:v.InError,errorMessage:f})}return i(R,{children:[p?e(L,{}):r?e(d,{paddingBottom:8,children:"You cannot create a new contest when you have a running contest."}):l?e(d,{paddingBottom:8,children:"Be sure to close your latest contest to be able to create a new one!"}):e(R,{paddingBottom:8,children:e(z,{text:"CREATE CONTEST",onClick:E,color:"pink"})}),e(Me,{onClose:N,isOpen:w,modalContent:u.status==v.InTransaction?e($,{message:"Your contest is being created...",txHash:u.txHash,inProgress:!0}):u.status==v.Done?e($,{message:"Your contest has been created click on OK to open it!",txHash:u.txHash,inProgress:!1,onClose:()=>{N(),s("/contest/"+u.contestId,{relative:!1})}}):e(Gt,{onCreateContest:(T,f,H,B)=>{C({status:v.NotStarted}),y(T,f,H,B)},errorMessage:u.errorMessage})})]})}function Zt(){const n=Ue(),[t,s]=At(),[o,r]=c.useState(!0),[a,l]=c.useState(F.Join),[h,p]=c.useState({}),[m,u]=c.useState({}),[C,w]=c.useState({}),E=()=>a==F.Mine?C:a==F.Closed?m:h,N=()=>a==F.Mine&&t.connected;c.useEffect(()=>{const f=n.pageType;l(f),O(f),x.onContestsUpdate=()=>{O(f)}},[n,t]);async function O(f){r(!0),await x.loadContract(),f==F.Mine?T():f==F.Closed?M():y()}async function y(){const f=await x.getAllRunningContests();p(f),r(!1)}async function M(){const f=await x.getAllEndedContests();u(f),r(!1)}async function T(){if(t.connected){const f=await x.getAllContestsOf(t);w(f)}else w([]);r(!1)}return i(R,{children:[e(Bt,{pageType:a}),e(Q,{w:"100%",flexDirection:"column",alignItems:"center",marginBottom:16,children:o?e(Je,{}):i(L,{children:[N()?e(Xt,{contests:C,accountData:t}):e(L,{}),e(Ut,{type:a,contests:E(),isConnected:t.connected})]})})]})}function en({params:n}){var t=F.Join;return n.type=="ended"?t=F.Closed:n.type=="mine"&&(t=F.Mine),{pageType:t}}function ve(){const n=kt();return e(R,{w:"100vw",mt:8,children:i(k,{spacing:4,children:[e(W,{src:"/res/logo.png",alt:"ArtPug logo",boxSize:82,position:"relative"}),i(k,{spacing:2,children:[e(d,{as:"b",fontSize:"xl",children:"Woofps!"}),e(d,{fontSize:"l",children:"Sorry, an unexpected error has occurred."})]}),e(d,{as:"i",fontSize:"md",color:"rgb(212,136,155, 1)",children:n.statusText||n.message})]})})}function tn({canVote:n,nbVotes:t,onItemClicked:s}){const[o,r]=c.useState(!1);return c.useEffect(()=>{r(!1)},[n,t]),n?e(z,{text:"VOTE",alignSelf:"center",color:"pink",width:"100%",inProgress:o,onClick:()=>{r(!0),s()}}):i(I,{spacing:1,alignSelf:"start",color:"pink",fontWeight:"bold",children:[e(J,{as:Ye}),e(d,{children:t})]})}function nn({accountData:n,contestInfo:t,entry:s,nbVotes:o,errorMessage:r,onVote:a}){const[l,h]=c.useState(!0),[p,m]=c.useState(!1),[u,C]=c.useState(void 0);c.useEffect(()=>{w()},[u,n,t,o,r]);async function w(){console.log("wut"),await x.loadContract();const E=await x.hasVotedFor(n,s);C(E),m(!t.isOver()&&!t.isInactive()&&n.connected&&!n.equalToOwner(s.owner)&&!E),h(!1)}return e(Ct,{width:"100%",position:"absolute",bottom:2,backgroundColor:"transparent",children:i(k,{width:"90%",alignSelf:"center",alignItems:"center",backgroundColor:"#171923",padding:4,spacing:2,sx:{borderRadius:"8px"},children:[i(I,{spacing:1,alignSelf:"start",color:"pink",fontWeight:"bold",cursor:"pointer",onClick:()=>{window.open("https://sepolia.etherscan.io/address/"+s.owner,"_blank","noreferrer")},fontSize:"0.8em",children:[e(J,{as:je}),e(d,{children:Oe(s.owner)})]}),e(d,{alignSelf:"start",children:s.title}),e(Ce,{title:"Failed to vote:",errorMessage:r}),l?e(wt,{width:"100%",size:"xs",isIndeterminate:!0,colorScheme:"pink"}):n.connected?e(tn,{canVote:p,nbVotes:o,onItemClicked:a}):i(k,{children:[e(Be,{}),e(d,{fontSize:"sm",children:"You must be connected to see the number of votes and vote for this entry"})]})]})})}function sn({accountData:n,contestInfo:t,entry:s,index:o}){const r=Te(),[a,l]=c.useState(!1),[h,p]=c.useState(s.nbVotes.toNumber()),{isOpen:m,onOpen:u,onClose:C}=Ae(),[w,E]=c.useState({});async function N(){l(!0)}async function O(){l(!1)}async function y(){try{const M=await x.voteOn(n,t.contest,o,"Empty message.",()=>{E({status:v.Done}),r({title:"You voted!",position:"top-right",status:"success",isClosable:!0}),p(h+1)});E({status:v.InTransaction,txHash:M}),u()}catch(M){const T=De(M);console.log("Unable to vote on the entry with error: "+T),E({status:v.InError,errorMessage:T})}}return i(R,{position:"relative",onMouseEnter:N,onMouseLeave:O,children:[e(W,{w:"100%",objectFit:"cover",minH:316,maxH:632,mb:2,sx:{borderRadius:"1%"},d:"inline-block",src:s.image,alt:"Alt"}),a?e(nn,{accountData:n,contestInfo:t,nbVotes:h,entry:s,index:o,onVote:y,errorMessage:w.errorMessage}):e(L,{}),e(Me,{onClose:C,isOpen:m,modalContent:w.status==v.InTransaction?e($,{message:"Your vote is being processed...",txHash:w.txHash,inProgress:!0}):e($,{message:"Well done! You voted!",txHash:w.txHash,inProgress:!1,onClose:()=>{C(),E({})}})})]})}function on({accountData:n,contestInfo:t}){return e(R,{padding:4,w:"100%",maxWidth:"1170px",mx:"auto",sx:{columnCount:[1,2,3],columnGap:"8px"},children:t.entries.map((s,o)=>e(sn,{accountData:n,contestInfo:t,entry:s,index:o},s.id))})}function rn({contestInfo:n}){return i(k,{spacing:2,paddingBottom:8,children:[e(d,{fontSize:"2em",children:n.contest.title}),i(I,{spacing:4,children:[n.isCancelled?i(I,{spacing:1,fontWeight:"bold",color:"rgb(212,136,155, 1)",children:[e(bt,{}),e(d,{fontSize:"1em",children:"Cancelled"})]}):n.isOver()?i(I,{spacing:1,fontWeight:"bold",color:"green.500",children:[e(yt,{}),e(d,{fontSize:"1em",children:"Done"})]}):i(I,{spacing:1,children:[e(_e,{}),e(d,{fontSize:"1em",children:Ge(ne(n.contest.endDate))})]}),i(I,{spacing:1,children:[e(J,{as:Nt}),n.nbEntries()==null?e(Ie,{isIndeterminate:!0,size:4,color:"pink"}):e(d,{fontSize:"1em",children:n.nbEntries()})]}),i(I,{spacing:1,children:[e(J,{as:Pt}),e(d,{fontSize:"1em",children:n.rewardInEth()+"Ξ"})]})]})]})}function an({winner:n}){return i(k,{paddingTop:4,children:[i(I,{children:[e(W,{objectFit:"cover",maxW:312,maxH:312,mb:2,sx:{borderRadius:"8px"},d:"inline-block",src:n.image,alt:"Alt"}),i(k,{alignSelf:"top",padding:8,sx:{borderRadius:"8px"},backgroundColor:"#171923",alignItems:"start",children:[i(I,{spacing:1,color:"pink",fontWeight:"bold",cursor:"pointer",onClick:()=>{window.open("https://sepolia.etherscan.io/address/"+n.owner,"_blank","noreferrer")},fontSize:"0.8em",children:[e(d,{children:"WINNER: "}),e(J,{as:je}),e(d,{children:Oe(n.owner)})]}),e(I,{children:e(d,{children:n.title})}),i(I,{spacing:1,color:"pink",fontWeight:"bold",children:[e(J,{as:Ye}),e(d,{children:n.nbVotes.toNumber()})]})]})]}),e(Be,{})]})}function Ve({title:n,subtitle:t,errorTitle:s,errorMessage:o,onAction:r}){const[a,l]=c.useState(!1),h=p=>{l(!0),r()};return c.useEffect(()=>{l(!1)},[o]),i(oe,{children:[e(re,{children:n}),e(ie,{}),e(ae,{children:t}),e(ce,{children:i(k,{width:"100%",alignItems:"start",children:[e(Ce,{title:s,errorMessage:o}),e(z,{text:"CONFIRM",onClick:h,color:"pink",width:"100%",inProgress:a})]})})]})}function cn({onCreateEntry:n,errorMessage:t}){const[s,o]=c.useState(""),[r,a]=c.useState(""),[l,h]=c.useState(!0),[p,m]=c.useState(!0),[u,C]=c.useState(!1),w=y=>y.length>3&&y.length<=45,E=y=>{o(y.target.value),h(se(y.target.value))},N=y=>{a(y.target.value),m(w(y.target.value))};async function O(){const y=se(s),M=w(r);h(y),m(M),y&&M&&(C(!0),n(r,s))}return c.useEffect(()=>{C(!1)},[t]),i(We,{spacing:4,children:[e(Ke,{title:"Title",placeholder:"Enter the title of you entry",help:"Your title must be longer than 3 characters and shorter than 45 characters.",value:r,onChange:N,isValid:p}),e($e,{title:"Image",placeholder:"Enter the image of you entry",help:"Enter a valid image url.",value:s,onChange:E,isValid:l,full:!0}),e(Ce,{title:"Failed to create the entry:",errorMessage:t}),e(z,{text:"CREATE",onClick:O,color:"pink",inProgress:u})]})}function ln({onCreateEntry:n,errorMessage:t}){return i(oe,{children:[e(re,{children:"Create a new Entry"}),e(ie,{}),e(ae,{children:e(cn,{onCreateEntry:n,errorMessage:t})}),e(ce,{})]})}function dn({contestInfo:n,accountData:t}){return n.isCancelled?e(d,{children:"The contest has been canceled, all participants must have received a refund."}):n.isOver()?n.contest.ended?e(d,{children:"The contest is over and the reward has been distributed."}):t.connected&&t.equalToOwner(n.contest.owner)?e(d,{children:'The contest is over, click on "CLOSE" to distribute the reward to the winner.'}):e(d,{children:"The contest is over, waiting for the owner to get the winner."}):t.connected?n.hasEntries()?e(d,{children:"The contest is in progress don't hesitate to add your entry or like other entries!"}):e(d,{children:"Be the first to participate in this contest!"}):e(d,{children:"You must connect your wallet to be able to be able to interact with this contest."})}function hn({accountData:n,contestInfo:t,onActionPerformed:s}){const o=Te(),[r,a]=c.useState(!1),[l,h]=c.useState({}),[p,m]=c.useState(!1),[u,C]=c.useState(!0),[w,E]=c.useState(!0),[N,O]=c.useState(!0),[y,M]=c.useState(!0),[T,f]=c.useState(!0),[H,B]=c.useState(!0),{isOpen:U,onOpen:Y,onClose:le}=Ae();c.useEffect(()=>{C(!0),b()},[n,t]);async function b(){const D=t.isCancelled||t.isOver(),j=n.connected&&n.equalToOwner(t.contest.owner);var q=!1;if(n.connected){for(var ye=0;ye<t.entries.length;ye++)if(t.entries[ye].owner.toLowerCase()==n.account.toLowerCase()){q=!0;break}}E(D),O(j),M(!t.isInactive()&&j),f(D&&t.winner.owner!=0),B(n.connected&&!D&&!q),C(!1)}async function de(D,j){try{const q=await x.addEntry(n,t.contest,D,j,()=>{h({status:v.Done}),o({title:"Your entry has been created!",position:"top-right",status:"success",isClosable:!0}),s("create")});h({status:v.InTransaction,txHash:q})}catch(q){we(q)}}async function he(){try{const D=await x.endContest(n,t.contest,()=>{h({status:v.Done}),o({title:"Your contest has been closed!",position:"top-right",status:"success",isClosable:!0}),s("close")});h({status:v.InTransaction,txHash:D})}catch(D){we(D)}}async function Qe(){try{const D=await x.cancelContest(n,t.contest,()=>{h({status:v.Done}),o({title:"Your contest has been canceled!",position:"top-right",status:"success",isClosable:!0}),s("cancel")});h({status:v.InTransaction,txHash:D})}catch(D){we(D)}}function we(D){const j=De(D);console.log("Failed to execute the action with error: "+j),h({status:v.InError,errorMessage:j})}async function Xe(){be(),Y()}async function Ze(){be(),a(!0),Y()}async function et(){be(),m(!0),Y()}function be(){h({}),a(!1),m(!1)}return i(L,{children:[i(k,{paddingBottom:4,spacing:2,w:"100%",maxWidth:"1170px",mx:"auto",children:[e(dn,{contestInfo:t,accountData:n}),u?e(Ie,{isIndeterminate:!0,size:4,color:"pink"}):i(L,{children:[H?e(z,{text:"ADD AN ENTRY FOR "+ +ke(t.entryPrice)+"Ξ",onClick:Xe,color:"pink"}):e(L,{}),y?e(z,{text:w?"CLOSE":"CANCEL",onClick:w?et:Ze,color:"pink"}):e(L,{}),T?e(an,{winner:t.winner}):e(L,{})]})]}),e(Me,{onClose:le,isOpen:U,modalContent:l.status==v.InTransaction?e($,{message:p?"Your contest is being closed...":r?"Your contest is being canceled...":"Your entry is being created...",txHash:l.txHash,inProgress:!0}):l.status==v.Done?e($,{message:p?"Your contest has been closed!":r?"Your contest has been canceled":"Your entry has been created!",txHash:l.txHash,inProgress:!1,onClose:()=>{le(),h({})}}):p?e(Ve,{title:"The contest is over!",subtitle:"Click on confirm to sent the reward to the winner and withdraw your profit!",errorTitle:"Failed to close the contest:",errorMessage:l.errorMessage,onAction:he}):r?e(Ve,{title:"Cancelling... are you sure?",subtitle:"By canceling the contest in progress, all participants will be refunded. No winner will be drawn.",errorTitle:"Failed to cancel the contest:",errorMessage:l.errorMessage,onAction:Qe}):e(ln,{onCreateEntry:de,errorMessage:l.errorMessage})})]})}function un({accountData:n,contest:t}){const[s,o]=c.useState(t),[r,a]=c.useState(!0);c.useEffect(()=>{l()},[]);async function l(){a(!0),await x.loadContract();const u=await x.updateContestInfo(t,n);o(u),a(!1)}async function h(){const u=await x.closeContestInfo(s,n);o(u)}async function p(){const u=await x.cancelContestInfo(s,n);o(u)}async function m(){const u=await x.updateEntries(s,n);o(u)}return e(R,{position:"relative",children:i(Q,{w:"100%",height:256,flexDirection:"column",alignItems:"center",marginBottom:16,children:[e(rn,{contestInfo:s}),r?e(Je,{}):i(L,{children:[e(hn,{accountData:n,contestInfo:s,onActionPerformed:u=>{u=="close"?h():u=="cancel"?p():m()}}),e(on,{accountData:n,contestInfo:s})]})]})})}function gn(){return i(k,{spacing:4,paddingBottom:8,children:[e(_,{w:"45%",h:12}),i(I,{spacing:4,children:[i(I,{spacing:1,children:[e(Ee,{}),e(_,{w:10,h:4})]}),i(I,{spacing:1,children:[e(Ee,{}),e(_,{w:10,h:4})]}),i(I,{spacing:1,children:[e(Ee,{}),e(_,{w:10,h:4})]})]})]})}async function pn({params:n}){return{contestId:n.id}}function fn(){const[n,t]=c.useState(ge),[s,o]=c.useState({}),[r,a]=c.useState(!0),{contestId:l}=Ue();c.useEffect(()=>{K.initAndConnect(p=>{t(p)}),h()},[]);async function h(){await x.loadContract(),o(await x.getContestInfo(l)),a(!1)}return i(R,{w:"100vw",children:[r?e(L,{}):i(R,{children:[e(W,{src:s.contest.banner,objectFit:"cover",position:"absolute",width:"100%",height:464,alt:"Contest banner"}),e(Q,{position:"absolute",bgGradient:"linear(to-b, rgba(0, 0, 0, 0.3), #1A202C)","z-index":"2",width:"100%",height:464})]}),e(qe,{accountData:n}),r?e(gn,{}):e(un,{accountData:n,contest:s})]})}const mn=Dt([{path:"/",element:e(Rt,{}),errorElement:e(ve,{}),children:[{path:"/contests/:type",element:e(Zt,{}),errorElement:e(ve,{}),loader:en},{path:"/",element:e(Mt,{replace:!0,to:"/contests/join"})}]},{path:"/contest/:id",element:e(fn,{}),errorElement:e(ve,{}),loader:pn}]);St.createRoot(document.getElementById("root")).render(i(Et,{children:[localStorage.setItem("chakra-ui-color-mode","dark"),e(Ot,{router:mn})]}));
